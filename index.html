<!DOCTYPE html>
<html>

<head>
    <script>
        
	function processdata(inputarray){
		console.log("process data");		
		console.log(inputarray[0]);
		console.log(inputarray);
		
	}
 	function loadfile(fileinput) {
	    file=fileinput.files[0];
	    reader = new FileReader();
	    reader.readAsArrayBuffer(file);
	    reader.onload = function() {
	
			arrayBuffer = reader.result;
			floatarray = new  Float32Array(arrayBuffer);
			console.log(floatarray);
			processdata(floatarray);   
	    
	    };
    	}
	    
    	function loadfile2(fileinput) {
		console.log(fileinput.files.length);
		for (i=0;i<fileinput.files.length;i++){

			console.log("iter");
			console.log(i);
			file=fileinput.files[i];
			    reader = new FileReader();
			    reader.readAsArrayBuffer(file);
			    reader.onload = function() {
	
			arrayBuffer = reader.result;
			floatarray = new  Float32Array(arrayBuffer);
			console.log(floatarray);
			processdata(floatarray);   
	    
	    };
		}
		
	    
    	}
	    
 	function loadmultiplefiles(fileinput) {
	    function loadsinglefile(i) {
		    file=fileinput.files[i];
		    reader = new FileReader();
		    reader.readAsArrayBuffer(file);
		    reader.onload = function() {
	
			arrayBuffer = reader.result;
			floatarray = new  Float32Array(arrayBuffer);
			console.log(floatarray);
			processdata(floatarray);   
	    
		    };
		    if (i<fileinput.files.length){
			    loadsinglefile(i+1);
		    }
	     }
  	     loadsinglefile(0);
	}

	   



const upload = async (event) => {
  
    // Convert the FileList into an array and iterate
    let files = Array.from(event.target.files).map(file => {

        // Define a new file reader
        let reader = new FileReader();

        // Create a new promise
        return new Promise(resolve => {

            // Resolve the promise after reading file
            reader.onload = () => resolve(reader.result);

            // Read the file as a text
            reader.readAsArrayBuffer(file);

        });

    });

    // At this point you'll have an array of results
    let res = await Promise.all(files);
	console.log("here");
	console.log(res);
	for (i=0;i<res.length;i++){
		console.log(i);
		floatarray = new  Float32Array(res[i]);
		console.log(floatarray);
		console.log( new  Float32Array(res[i]));
	}
  
}
    

       
    </script>
</head>

<body>
<p> aff </p>
    <input multiple type="file" id="FILE_INPUT" onchange="loadfile2(this)" />

	
<input onchange = 'upload(event)' type = 'file' multiple/>
</body>

</html>
