<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content=
		"width=device-width, initial-scale=1.0">
</head> 

<body>
	
	<div id="INPUT_TAB_0" class="tabcontent">     <!-- TAB 0:  >
	
		<form id="INPUT_FORM_0">
			
		    <div class="form-control">        <!-- strings  >
		        <label for="STRING_0">Insert A String:</label>
		        <input id="STRING_0" name="csvString" type="text" value="ciao some string" />
		    </div>
		
		    <div class="form-control">        <!-- numbers  >
		        <label for="NUMBER_0">Insert A Number:</label>
		        <input id="NUMBER_0" name="csvNumber" type="number" value="-4.56" />
		    </div>
		
		    <div class="form-control">        <!-- longer strings???  >
		        <label for="LONGTEXT_0">Enter a Message</label>
		        <textarea id="LONGTEXT_0" name="csvLongText" rows="6" cols="65"></textarea>
		    </div>
		
		    <div class="form-control">        <!-- logical  >
			<label for="LOGICAL_0">Check the logical box:</label>
			<input id="LOGICAL_0" name="csvLogical" type="checkbox" value="wasChecked" checked>
		    </div>

		    <div class="form-control">        <!-- multiple choice, radio buttons  >
			Language Choice:
			<label for="MULTIPLECHOICE_0_A">Choice A</label>
			<input id="MULTIPLECHOICE_0_A" name="csvMultiplechoice0" type="radio" value="selectedA">
			<label for="MULTIPLECHOICE_0_B">Choice B</label>
			<input id="MULTIPLECHOICE_0_B" name="csvMultiplechoice0" type="radio" value="selectedB"  checked>
			<label for="MULTIPLECHOICE_0_C">Choice C</label>
			<input id="MULTIPLECHOICE_0_C" name="csvMultiplechoice0" type="radio" value="selectedC">
		    </div>
		
	    <button id="bbb" class="btn" type="submit">Send</button>
	</form>
	</div>
		
	<div id="INPUT_TAB_1" class="tabcontent">
	
		<form id="INPUT_FORM_1">
		
	    <div class="form-control">
	        <label for="name2">Full Name</label>
	        <input id="name2" name="name2" type="text" value="Cris2" />
	    </div>
	   
		
	    <button id="bbb2" class="btn" type="submit">Send2</button>
	</form>
	</div>
	
		
	<button class="tablink" onclick="openTab('INPUT_TAB_0', this, 'red')" id="defaultOpen">London</button>
	<button class="tablink" onclick="openTab('INPUT_TAB_1', this, 'green')" id="notDefaultOpen">Paris</button>
	
<script type="text/javascript">
	
function openTab(tabName, elmnt, color) {
  // Hide all elements with class="tabcontent" by default */
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }

  // Remove the background color of all tablinks/buttons
  tablinks = document.getElementsByClassName("tablink");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].style.backgroundColor = "";
  }

  // Show the specific tab content
  document.getElementById(tabName).style.display = "block";

  // Add the specific color to the button used to open the tab content
  elmnt.style.backgroundColor = color;
}


	

const download = function (data) {

	// Creating a Blob for having a csv file format
	// and passing the data with type
	const blob = new Blob([data], { type: 'text/csv' });

	// Creating an object for downloading url
	const url = window.URL.createObjectURL(blob)

	// Creating an anchor(a) tag of HTML
	const a = document.createElement('a')

	// Passing the blob downloading url
	a.setAttribute('href', url)

	// Setting the anchor tag attribute for downloading
	// and passing the download file name
	a.setAttribute('download', 'download.csv');

	// Performing a download with click
	a.click()
}

const csvmaker = function (data) {

console.log(data);
	
	// Empty array for storing the values
	csvRows = [];

	// Headers is basically a keys of an
	// object which is id, name, and
	// profession
	const headers = Object.keys(data);	
	const values = Object.values(data);

	
	for (let i = 0; i < headers.length; i++) {
		const line = [ headers[i], values[i] ];		
		csvRows.push(line.join(','));
	}
	
	// Returning the array joining with new line
	return csvRows.join('\n')
}

const callbackFunction = async function (event) {
		
	event.preventDefault();
    	const myFormData = new FormData(event.target);
     	const data = Object.fromEntries(myFormData.entries());
	
	const csvdata = csvmaker(data);
	download(csvdata);			
}


const form = document.getElementById('INPUT_FORM_0');
form.addEventListener('submit', callbackFunction);


// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();	
		
</script>
</body>
</html>
